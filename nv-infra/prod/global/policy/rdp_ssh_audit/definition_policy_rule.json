{
    "if":{
       "allOf":[
          {
             "equals":"Microsoft.Network/networkSecurityGroups/securityRules",
             "field":"type"
          },
          {
             "allOf":[
                {
                   "equals":"Allow",
                   "field":"Microsoft.Network/networkSecurityGroups/securityRules/access"
                },
                {
                   "equals":"Inbound",
                   "field":"Microsoft.Network/networkSecurityGroups/securityRules/direction"
                },
                {
                   "anyOf":[
                      {
                         "equals":"22",
                         "field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange"
                      },
                      {
                         "equals":"3389",
                         "field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange"
                      },
                      {
                         "equals":"*",
                         "field":"Microsoft.Network/networkSecurityGroups/securityRules/destinationPortRange"
                      }
                   ]
                },
                {
                   "anyOf":[
                      {
                         "equals":"*",
                         "field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"
                      },
                      {
                         "equals":"Internet",
                         "field":"Microsoft.Network/networkSecurityGroups/securityRules/sourceAddressPrefix"
                      }
                   ]
                }
             ]
          }
       ]
    },
    "then":{
       "effect":"[parameters('effect')]"
    }
 }